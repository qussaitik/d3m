<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@500;800;900&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #6c5ce7; --secondary: #00cec9; --bg: #f8f9fd; --text: #2d3436; }
        body { font-family: 'Tajawal', sans-serif; background: var(--bg); margin: 0; padding: 20px; }
        .order-card { background: white; padding: 30px; border-radius: 25px; max-width: 400px; margin: 50px auto; box-shadow: 0 15px 35px rgba(0,0,0,0.05); text-align: center; }
        input { width: 100%; padding: 15px; margin: 10px 0; border-radius: 12px; border: 2px solid #f1f2f6; box-sizing: border-box; }
        .btn-send { width: 100%; padding: 15px; background: linear-gradient(135deg, var(--primary), var(--secondary)); color: white; border: none; border-radius: 12px; font-weight: 900; cursor: pointer; }
        .service-badge { background: #f0eeff; color: var(--primary); padding: 5px 15px; border-radius: 20px; font-size: 14px; margin-bottom: 20px; display: inline-block; }
    </style>
</head>
<body>
    <script>if(!sessionStorage.getItem('currentUser')) window.location.href="index.html";</script>
    <div class="order-card">
        <div id="service-name" class="service-badge">...</div>
        <h2>Ø£ÙƒÙ…Ù„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ âœ¨</h2>
        <input type="text" id="link" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„Ø­Ø³Ø§Ø¨/Ø§Ù„ÙÙŠØ¯ÙŠÙˆ">
        <input type="number" id="qty" placeholder="Ø§Ù„ÙƒÙ…ÙŠØ©">
        <button id="submitBtn" class="btn-send" onclick="sendOrder()">ØªØ£ÙƒÙŠØ¯ ÙˆØ¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</button>
    </div>
    <script>
        const scriptURL = "https://script.google.com/macros/s/AKfycbz33uo9f-5eVXAFaI6qfk5ce-mgSX-tQ0q7HjDlYFa4akBvn3NuaUh5fuqYYMc1FEA/exec";
        const service = localStorage.getItem('chosenService');
        const user = sessionStorage.getItem('currentUser');
        document.getElementById('service-name').innerText = "Ø§Ù„Ø®Ø¯Ù…Ø©: " + service;

        async function sendOrder() {
            const link = document.getElementById('link').value;
            const qty = document.getElementById('qty').value;
            if(!link || !qty) return alert("Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
            const btn = document.getElementById('submitBtn');
            btn.disabled = true; btn.innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸...";

            try {
                await fetch(scriptURL, { method: "POST", mode: "no-cors", body: JSON.stringify({ action: "addOrder", user: user, service: service, link: link, qty: qty, date: new Date().toLocaleString('ar-EG') }) });
                const msg = `Ù…Ø±Ø­Ø¨Ø§Ù‹ Ù‚ØµÙŠØŒ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯:%0AğŸ‘¤ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ${user}%0Aâœ¨ Ø§Ù„Ø®Ø¯Ù…Ø©: ${service}%0AğŸ”¢ Ø§Ù„ÙƒÙ…ÙŠØ©: ${qty}%0AğŸ”— Ø§Ù„Ø±Ø§Ø¨Ø·: ${link}`;
                alert("ØªÙ…! Ø³ÙŠØªÙ… ØªØ­ÙˆÙŠÙ„Ùƒ Ù„Ù„ÙˆØ§ØªØ³Ø§Ø¨");
                window.location.href = `https://wa.me/972555630038?text=${msg}`;
            } catch(e) { alert("Ø®Ø·Ø£!"); btn.disabled = false; }
        }
    </script>
</body>
</html>
