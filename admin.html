<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… | Ø§Ù„Ù…ØµÙŠØ¨Ø©</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Tajawal', sans-serif; background: #f0f2f5; margin: 0; padding: 20px; }
        .card { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); margin-bottom: 20px; }
        table { width: 100%; border-collapse: collapse; background: white; }
        th, td { padding: 12px; text-align: right; border-bottom: 1px solid #eee; }
        th { background: #302b63; color: white; }
        input { width: 70px; padding: 5px; border-radius: 5px; border: 1px solid #ccc; }
        .btn-add { background: #27ae60; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; }
        .btn-sub { background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; }
    </style>
</head>
<body>
    <div class="card">
        <h3>ğŸ’° Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø±ØµØ¯Ø©</h3>
        <div style="display: flex; gap: 20px; flex-wrap: wrap;">
            <div>
                <b>Ù†Ø¬Ù„Ø§Ø¡:</b> 
                <input type="number" id="amt_Ù†Ø¬Ù„Ø§Ø¡"> 
                <button class="btn-add" onclick="updateBal('Ù†Ø¬Ù„Ø§Ø¡','add')">Ø¥Ø¶Ø§ÙØ©</button>
                <button class="btn-sub" onclick="updateBal('Ù†Ø¬Ù„Ø§Ø¡','sub')">Ø³Ø­Ø¨</button>
            </div>
            <div>
                <b>ÙˆØ±Ø¯Ù‡:</b> 
                <input type="number" id="amt_ÙˆØ±Ø¯Ù‡"> 
                <button class="btn-add" onclick="updateBal('ÙˆØ±Ø¯Ù‡','add')">Ø¥Ø¶Ø§ÙØ©</button>
                <button class="btn-sub" onclick="updateBal('ÙˆØ±Ø¯Ù‡','sub')">Ø³Ø­Ø¨</button>
            </div>
        </div>
    </div>

    <div class="card">
        <h3>ğŸ“¦ Ø³Ø¬Ù„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h3>
        <table>
            <thead><tr><th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th><th>Ø§Ù„Ø®Ø¯Ù…Ø©</th><th>Ø§Ù„ÙƒÙ…ÙŠØ©</th><th>Ø§Ù„Ø±Ø§Ø¨Ø·</th><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th></tr></thead>
            <tbody id="list"></tbody>
        </table>
    </div>

    <script>
        const scriptURL = "https://script.google.com/macros/s/AKfycbx-CzLtyGIJyoggh6GqSahiumRMrErOMAoXA1pjYdbECXp2PSEke1zXLyelzldXCxin/exec";

        async function updateBal(u, t) {
            const val = document.getElementById('amt_'+u).value;
            if(!val) return alert("Ø£Ø¯Ø®Ù„ Ù…Ø¨Ù„Øº");
            fetch(scriptURL, { method: "POST", mode: "no-cors", body: JSON.stringify({ action: "updateBalance", user: u, amount: val, type: t }) });
            alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ù„ØªØ­Ø¯ÙŠØ« Ø±ØµÙŠØ¯ " + u);
            document.getElementById('amt_'+u).value = "";
        }

        async function load() {
            try {
                const res = await fetch(scriptURL + "?action=getOrders");
                const data = await res.json();
                document.getElementById('list').innerHTML = data.reverse().map(o => `<tr><td>${o.user}</td><td>${o.service}</td><td>${o.qty}</td><td><a href="${o.link}" target="_blank">ÙØªØ­</a></td><td><small>${o.date}</small></td></tr>`).join('');
            } catch(e) {}
        }
        load();
        setInterval(load, 15000);
    </script>
</body>
</html>
