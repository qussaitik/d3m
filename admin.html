<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© | Ø§Ù„Ù…ÙØµÙŠØ¨Ø©</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Tajawal', sans-serif; background: #05011a; color: white; text-align: center; padding: 20px; }
        .login-box { background: #1a1c23; padding: 30px; border-radius: 20px; border: 2px solid #00f2ea; display: inline-block; margin-top: 100px; }
        input { padding: 12px; margin: 10px; border-radius: 8px; border: none; text-align: center; width: 250px; font-size: 18px; }
        button { padding: 12px 30px; background: #00f2ea; color: black; font-weight: bold; border: none; border-radius: 8px; cursor: pointer; }
        #admin-main { display: none; }
        .card { background: #1f222b; padding: 20px; border-radius: 15px; margin-top: 20px; border: 1px solid #333; max-width: 500px; margin-left: auto; margin-right: auto; }
        .user-row { display: flex; justify-content: space-between; align-items: center; background: #2a2e38; padding: 10px; border-radius: 10px; margin-bottom: 8px; }
    </style>
</head>
<body>

    <div id="admin-lock">
        <div class="login-box">
            <h2>Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¯ÙŠØ± ğŸ›¡ï¸</h2>
            <input type="password" id="passInput" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±">
            <br>
            <button onclick="checkPass()">Ø¯Ø®ÙˆÙ„ Ù…Ø¨Ø§Ø´Ø±</button>
        </div>
    </div>

    <div id="admin-main">
        <div class="card">
            <h3 style="color: #00f2ea;">ğŸ’° Ø£Ø±ØµØ¯Ø© Ø§Ù„Ù…Ù„ÙƒØ§Øª</h3>
            <div id="balances-container">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
        </div>
    </div>

    <script>
        // Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø¬Ø¯ÙŠØ¯ ØªØ¨Ø¹Ùƒ
        const scriptURL = "https://script.google.com/macros/s/AKfycbwUT0hkoVkAAPo9TeWIOYoQVMJPtrWDnMNorramxeusX4UPHPlwREE7ti3zGsaHj7Lk/exec";
        const SECRET = "0598787757"; // ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±

        function checkPass() {
            const input = document.getElementById('passInput').value;
            if (input === SECRET) {
                document.getElementById('admin-lock').style.display = 'none';
                document.getElementById('admin-main').style.display = 'block';
                loadData();
            } else {
                alert("Ø§Ù„Ø¨Ø§Ø³ÙˆÙˆØ±Ø¯ ØºÙ„Ø· ÙŠØ§ Ù‚ØµÙŠ!");
            }
        }

        async function loadData() {
            try {
                const res = await fetch(scriptURL + "?action=getBalances");
                const balances = await res.json();
                const container = document.getElementById('balances-container');
                container.innerHTML = "";
                
                ['Ù†Ø¬Ù„Ø§Ø¡', 'ÙˆØ±Ø¯Ù‡', 'Ù…Ø±Ø­'].forEach(u => {
                    let b = balances[u] || 0;
                    container.innerHTML += `
                        <div class="user-row">
                            <span>ğŸ‘‘ ${u}</span>
                            <b style="color:cyan">$${b}</b>
                            <div>
                                <input type="number" id="amt_${u}" style="width:60px; padding:5px;" placeholder="0">
                                <button style="padding:5px 10px; background:green; color:white;" onclick="updateBal('${u}','add')">+</button>
                                <button style="padding:5px 10px; background:red; color:white;" onclick="updateBal('${u}','sub')">-</button>
                            </div>
                        </div>`;
                });
            } catch (e) {
                console.log("Error loading");
            }
        }

        async function updateBal(u, t) {
            const val = document.getElementById('amt_'+u).value;
            if(!val) return;
            await fetch(scriptURL, { method: "POST", mode: "no-cors", body: JSON.stringify({ action: "updateBalance", user: u, amount: val, type: t }) });
            setTimeout(loadData, 2000);
        }
    </script>
</body>
</html>
