<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø·Ù„Ø¨Ø§ØªÙŠ | Ø¹Ø§Ù„Ù… Ø§Ù„Ù…ØµÙŠØ¨Ø©</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@500;800;900&display=swap" rel="stylesheet">
    <style>
        :root { --p: #6c5ce7; --bg: #f4f7fe; --success: #00b894; --danger: #d63031; --warning: #fdcb6e; }
        body { font-family: 'Tajawal', sans-serif; background: var(--bg); padding: 20px; color: #2d3436; }
        .container { max-width: 600px; margin: auto; }
        .card { background: white; padding: 18px; border-radius: 22px; box-shadow: 0 8px 20px rgba(0,0,0,0.04); margin-bottom: 12px; border: 1px solid #edf2f7; text-align: right; }
        .status-badge { display: inline-block; padding: 5px 12px; border-radius: 10px; font-weight: 800; font-size: 12px; margin-top: 8px; }
        .st-pending { background: #fff9e6; color: var(--warning); border: 1px solid var(--warning); }
        .st-completed { background: #e6fffb; color: var(--success); border: 1px solid var(--success); }
        .st-cancelled { background: #fff5f5; color: var(--danger); border: 1px solid var(--danger); }
        .header { text-align: center; margin-bottom: 20px; }
        .no-orders { text-align: center; padding: 30px; background: white; border-radius: 20px; color: #b2bec3; font-weight: 800; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1 style="color:var(--p); font-weight:900; margin:0;">ğŸ“¦ Ø³Ø¬Ù„ Ø·Ù„Ø¨Ø§ØªÙŠ</h1>
    </div>
    <div id="orders-list"></div>
</div>

<script>
    const url = "https://script.google.com/macros/s/AKfycbzYqF3GdbE4XnMpyd9UXmRal0Ycw2UufleDVOC5S16gE-CbYaIpwbE-gAJqNoBbxqMo/exec";
    const user = localStorage.getItem('user');

    async function loadOrders() {
        if (!user) {
            document.getElementById('orders-list').innerHTML = '<div class="no-orders">Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹</div>';
            return;
        }

        try {
            const res = await fetch(url + "?action=getOrders");
            const data = await res.json();
            const myOrders = data.filter(o => o.user && o.user.toString().trim() === user.trim()).reverse();

            if (myOrders.length === 0) {
                document.getElementById('orders-list').innerHTML = '<div class="no-orders">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹</div>';
                return;
            }

            let html = "";
            myOrders.forEach(o => {
                let stClass = (o.status === "Ù…ÙƒØªÙ…Ù„") ? "st-completed" : (o.status === "Ù…Ù„ØºÙŠ" ? "st-cancelled" : "st-pending");
                html += `
                    <div class="card">
                        <div style="display:flex; justify-content:space-between;">
                            <b style="color:var(--p); font-size:16px;">${o.service}</b>
                            <small style="color:#bbb;">${o.date.split(' ')[0]}</small>
                        </div>
                        <p style="margin:8px 0; font-size:13px; color:#666;">Ø§Ù„ÙƒÙ…ÙŠØ©: ${o.qty} | Ø§Ù„Ø³Ø¹Ø±: ${o.price || '0$'}</p>
                        <div class="status-badge ${stClass}">${o.status || 'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©'}</div>
                    </div>`;
            });
            document.getElementById('orders-list').innerHTML = html;
        } catch (e) {
            document.getElementById('orders-list').innerHTML = '<div class="no-orders">Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„</div>';
        }
    }
    loadOrders();
</script>
</body>
</html>
